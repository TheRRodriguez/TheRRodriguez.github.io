<!DOCTYPE html>
<html>
<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		
		<link rel="stylesheet" type="text/css" href="../cdn.datatables.net/r/bs-3.3.5/jq-2.1.4%2cdt-1.10.8/datatables.min.css"/>
 
        <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        
		<script type="text/javascript" src="../cdn.datatables.net/r/bs-3.3.5/jqc-1.11.3%2cdt-1.10.8/datatables.min.js"></script>
		
		
		<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/js/select2.min.js"></script>
		
		<script type="text/javascript" charset="utf-8">
		var getArrayAvg = function(arr){
			var total = 0;
			var avg = 0;
			for(var i = 0; i < arr.length; i++) {
				total += arr[i];
			};
			avg = parseFloat(total / arr.length).toFixed(2);
			if(isNaN(avg))
			  avg = 0;
			
			return avg;
		};
		
			$(document).ready(function() {
				var table = $('#example').on( 'processing.dt', function ( e, settings, processing ) {
        $('#processingIndicator').css( 'display', processing ? 'block' : 'none' );
    } ).DataTable({
				  
				   "ajax": "http://hydratech.github.io/databasingcode/source.src",
				   initComplete:  function(){
				       this.api().columns().every( function (index) {
							var column = this;
							var select = $('<select class="footer-filter"><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
			 
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
			 
							column.data().unique().sort().each( function ( d, j ) {
								select.append( '<option value="'+d+'">'+d+'</option>' )
							} );
							if(index ===1){
							  var select_box = select.clone();
							  select_box.addClass('search');
							 $('#search_in').html(select_box);
							 $(select_box).select2({minimumInputLength:3, placeholder: 'Enter a username'})
							    .change(function(){
									$('.footer-filter').not('.search').val("").change();
									var player_name = $(this).val();
									var regExSearch = "^"+player_name+"$";
									table.search(player_name).draw();
									table.columns(1).search(regExSearch, true).draw();
									$('.player_name').html(player_name);
				                   var total_games = table.rows({ search:'applied', page:'all' } ).data().length;
								   var wins = 0;
								   var losses = 0;
								   var mods = 0;
								   var wolf = 0;
								   var human = 0;
								   var seer = 0;
								   var human_games = 0;
								   var wolf_games = 0;
								   var seer_games = 0;
								   var survive = 0;
								   var h_shot_rd = new Array();
								   var h_eaten_rd = new Array();
								   var w_shot_rd = new Array();
								   var s_die_rd = new Array();
								   
								   table.rows({ search:'applied', page:'all' } ).data()
								   .each(function(value, index) {
										console.log(value);
										var role = value[2];
										var fate = value[3];
										var rd = value[4];
										var result = value[5];
			
				$('#clear').click(function(){
				   console.log("clear");
				   $('.search').select2("val", "");
				   table.search( '' )
					 .columns().search( '' )
					 .draw('full-reset');
				   $('.ww_stat').children('td').html('');
				   $('.player_name').html('');
				});			
				
				
			} );
		</script>
		<style>
		  .footer {
				bottom: 0;
				width: 100%;
				height: 60px;
				background-color: #f5f5f5;
			}
		</style>
		
	</head>
	<body>
		<div class="container">
		<div class="row"><h1><span class="pull-left">WWG Database</span><div class="" style="">&nbsp;&nbsp;<button id="clear" type="button" class="btn btn-info"><span class="glyphicon glyphicon-refresh"></span> Clear All</button></div></h1>
		</div>
		<div class="row">
		<h3>Player Statistics Search 
		</h3> 
		<div class="">
		<div class="well input-group">
		  <label style="margin-right: 10px;">Player Name</label>
		  <span id="search_in">
		    <div class="alert alert-info"><strong>Data is loading... Please wait.</strong></div>
		  </span>
		</div><!-- /input-group -->
		
		<br>
		<!-- Total Result Pane -->
		<div class="panel panel-primary">
        <div id="" class="panel-heading">Total Stats: <span class="player_name"></span></div>
		<table id="player_stats" class="table table-bordered"><thead>
		<tr>
		<th>Name</th>
		<th>Contents</th>
		<th>Date Checked Out</th>
        <th>Date Returned</th> 
		<th>Checked Out?</th>
		<th>Current Owner</th> 
		</tr>
		</thead>
		<tbody>
		<tr id="stats_row" class="ww_stat"><td></td><td></td><td></td><td></td><td></td><td></td></tr>
		</tbody>
		</table>
		</div> <!-- /Total Result Pane -->
		<!-- Advanced stats -->
		<div id="">
		<!-- Human Result Pane -->
		<div class="panel panel-default">
		<table id="human_stats" class="table table-bordered"><thead>
		<tr>
		<th>Human Games Played</th>
		<th>Human Win %</th>
		<th>Wins</th>
		<th>Losses</th> 
		<th>Avg. Round Shot</th>
		<th>Avg. Round Eaten</th>
		</tr>
		</thead>
		<tbody>
		<tr id="human_stats_row" class="ww_stat">
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		</tr>
		</tbody>
		</table>
		</div> <!-- /Human Result Pane -->
		
		<!-- WOLF Result Pane -->
		<div class="panel panel-default">
        <div id="" class="panel-heading"><img src="http://www.braingle.com/games/werewolf/images/wolf.gif" width="16" height="16" alt="w"> Wolf Stats: <span class="player_name"></span></div>
		<table id="wolf_stats" class="table table-bordered"><thead>
		<tr>
		<th>Wolf Games Played</th>
		<th>Wolf Win %</th>
		<th>Wins</th>
		<th>Losses</th> 
		<th>Avg. Round Shot</th>
		</tr>
		</thead>
		<tbody>
		<tr id="wolf_stats_row" class="ww_stat">
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		</tr>
		</tbody>
		</table>
		</div> <!-- /WOLF Result Pane -->
		
		<!-- SEER Result Pane -->
		<div class="panel panel-default">
        <div id="" class="panel-heading"><img src="http://www.braingle.com/games/werewolf/images/wand.png" width="16" height="16" alt="s"> Seer Stats: <span class="player_name"></span></div>
		<table id="seer_stats" class="table table-bordered"><thead>
		<tr>
		<th>Seer Games Played</th>
		<th>Seer Win %</th>
		<th>Wins</th>
		<th>Losses</th> 
		<th>Avg. Round Caught</th>
		</tr>
		</thead>
		<tbody>
		<tr id="seer_stats_row" class="ww_stat">
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		</tr>
		</tbody>
		</table>
		</div> <!-- /WOLF Result Pane -->
		</div> <!-- /advanced stats  -->
		</div>
		
		</div>
		<div class="row">
		<h3>Game Statistics</h3>
		<table id="example" class="display" cellspacing="0" width="100%">
		<thead>
		<tr><th>Game No.</th><th>Player</th><th>Role</th><th>Fate</th><th>Round</th><th>Outcome</th><th>Total Game Rounds</th></tr></thead>
		</tbody>
		<tfoot><tr><th>Game No.</th><th>Player</th><th>Role</th><th>Fate</th><th>Round</th><th>Outcome</th><th>Total Game Rounds</th></tr></tfoot>
		</table>
		</div>
		
		</div>

<script type="text/javascript">
	// For demo to fit into DataTables site builder...
	$('#example')
		.removeClass( 'display' )
		.addClass('table table-striped table-bordered');
</script>
	</body>
	<footer class="footer"><div class="container"><div class="row"><p>Raw Data: <a href=" https://docs.google.com/spreadsheets/d/1SWVQIpgj1EtRgpvDVFi3Bv5NLNvSThB50gPFvTqB-7g/edit?usp=sharing"> Available Here </a></p>
	<p>Last Update April 04</p>
	</div></div></footer>

</html>